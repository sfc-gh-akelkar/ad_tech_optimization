name: patientpoint_maintenance_ops
description: >
  Semantic model for PatientPoint predictive maintenance demo.
  Designed for Snowflake Intelligence / Cortex Analyst. Uses curated ANALYTICS views.

tables:
  - name: fleet_device_status
    description: Current fleet health status (threshold-based) with device metadata.
    base_table:
      database: PREDICTIVE_MAINTENANCE
      schema: ANALYTICS
      table: V_FLEET_DEVICE_STATUS
    primary_key:
      columns: [DEVICE_ID]
    dimensions:
      - name: device_id
        expr: DEVICE_ID
        description: Unique screen identifier.
        synonyms: ["screen id", "device", "screen", "display"]
      - name: device_model
        expr: DEVICE_MODEL
        synonyms: ["model", "hardware model"]
      - name: facility_name
        expr: FACILITY_NAME
        synonyms: ["clinic", "site", "location", "facility"]
      - name: facility_city
        expr: FACILITY_CITY
        synonyms: ["city"]
      - name: facility_state
        expr: FACILITY_STATE
        synonyms: ["state", "region"]
      - name: environment_type
        expr: ENVIRONMENT_TYPE
        synonyms: ["placement", "room type", "lobby", "waiting room"]
      - name: overall_status
        expr: OVERALL_STATUS
        synonyms: ["health status", "status", "fleet status"]
      - name: temp_status
        expr: TEMP_STATUS
      - name: power_status
        expr: POWER_STATUS
    measures:
      - name: temperature_f
        expr: TEMPERATURE_F
        description: Current device internal temperature (F).
      - name: power_w
        expr: POWER_CONSUMPTION_W
        description: Current power consumption (W).
      - name: error_count
        expr: ERROR_COUNT
        description: Errors in last hour.
      - name: days_since_maintenance
        expr: DAYS_SINCE_MAINTENANCE
      - name: device_age_days
        expr: DEVICE_AGE_DAYS

  - name: device_telemetry_daily
    description: Daily aggregated telemetry (last 30 days).
    base_table:
      database: PREDICTIVE_MAINTENANCE
      schema: ANALYTICS
      table: V_DEVICE_TELEMETRY_DAILY
    dimensions:
      - name: device_id
        expr: DEVICE_ID
      - name: day
        expr: DAY
        synonyms: ["date", "day"]
    measures:
      - name: avg_temperature_f
        expr: AVG_TEMPERATURE_F
      - name: max_temperature_f
        expr: MAX_TEMPERATURE_F
      - name: avg_power_w
        expr: AVG_POWER_W
      - name: max_power_w
        expr: MAX_POWER_W
      - name: avg_latency_ms
        expr: AVG_LATENCY_MS
      - name: max_latency_ms
        expr: MAX_LATENCY_MS
      - name: avg_packet_loss_pct
        expr: AVG_PACKET_LOSS_PCT
      - name: total_errors
        expr: TOTAL_ERRORS
      - name: avg_cpu_pct
        expr: AVG_CPU_PCT
      - name: avg_mem_pct
        expr: AVG_MEM_PCT
      - name: avg_brightness
        expr: AVG_BRIGHTNESS

  - name: maintenance_incidents
    description: Maintenance incident history with enriched context.
    base_table:
      database: PREDICTIVE_MAINTENANCE
      schema: ANALYTICS
      table: V_MAINTENANCE_INCIDENTS
    dimensions:
      - name: maintenance_id
        expr: MAINTENANCE_ID
      - name: device_id
        expr: DEVICE_ID
      - name: incident_date
        expr: INCIDENT_DATE
        synonyms: ["incident time", "failure time"]
      - name: failure_type
        expr: FAILURE_TYPE
        synonyms: ["issue type", "failure mode"]
      - name: resolution_type
        expr: RESOLUTION_TYPE
        synonyms: ["resolution", "fix type", "remediation type"]
      - name: remote_fix_successful
        expr: REMOTE_FIX_SUCCESSFUL
        synonyms: ["resolved remotely", "remote fix worked"]
    measures:
      - name: total_cost_usd
        expr: TOTAL_COST_USD
        synonyms: ["cost", "service cost"]
      - name: downtime_hours
        expr: DOWNTIME_HOURS
        synonyms: ["downtime"]
      - name: revenue_impact_usd
        expr: REVENUE_IMPACT_USD
        synonyms: ["lost revenue", "revenue loss"]

  - name: baseline_pre_ml
    description: Baseline monitoring metrics (threshold-based, pre-ML).
    base_table:
      database: PREDICTIVE_MAINTENANCE
      schema: ANALYTICS
      table: V_BASELINE_PRE_ML
    dimensions:
      - name: as_of
        expr: AS_OF
    measures:
      - name: fleet_size
        expr: FLEET_SIZE
      - name: devices_critical
        expr: DEVICES_CRITICAL
      - name: devices_warning
        expr: DEVICES_WARNING
      - name: devices_healthy
        expr: DEVICES_HEALTHY
      - name: devices_requiring_review_today
        expr: DEVICES_REQUIRING_REVIEW_TODAY
      - name: charts_to_review_if_manual
        expr: CHARTS_TO_REVIEW_IF_MANUAL


